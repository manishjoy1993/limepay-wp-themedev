/*!

 * multiscroll.js 0.2.2

 * https://github.com/alvarotrigo/multiscroll.js

 * @license MIT licensed

 *

 * Copyright (C) 2016 alvarotrigo.com - A project by Alvaro Trigo

 */

!function(e,t,o,n,s){e.fn.multiscroll=function(i){var a=e.fn.multiscroll,l=e(this);i=e.extend({verticalCentered:!0,scrollingSpeed:700,easing:"easeInQuart",menu:!1,sectionsColor:[],anchors:[],navigation:!1,navigationPosition:"right",navigationColor:"#000",navigationTooltips:[],loopBottom:!1,loopTop:!1,css3:!1,paddingTop:0,paddingBottom:0,fixedElements:null,normalScrollElements:null,keyboardScrolling:!0,touchSensitivity:5,sectionSelector:".ms-section",leftSelector:".ms-left",rightSelector:".ms-right",afterLoad:null,onLeave:null,afterRender:null,afterResize:null},i);var r=600,c=navigator.userAgent.match(/(iPhone|iPod|iPad|Android|playbook|silk|BlackBerry|BB10|Windows Phone|Tizen|Bada|webOS|IEMobile|Opera Mini)/),m="ontouchstart"in t||navigator.msMaxTouchPoints>0||navigator.maxTouchPoints;".ms-right"!==i.rightSelector&&e(i.rightSelector).addClass("ms-right"),".ms-left"!==i.leftSelector&&e(i.leftSelector).addClass("ms-left");var d,v,f,h=e(".ms-left").find(".ms-section").length,u=!1,p=e(t).height(),g=function(){var e;e=t.PointerEvent?{down:"pointerdown",move:"pointermove"}:{down:"MSPointerDown",move:"MSPointerMove"};return e}(),S={touchmove:"ontouchmove"in t?"touchmove":g.move,touchstart:"ontouchstart"in t?"touchstart":g.down};function x(){var o=t.location.hash.replace("#","");if(o.length){var n=e(".ms-left").find('[data-anchor="'+o+'"]');("undefined"==typeof lastScrolledDestiny||o!==lastScrolledDestiny)&&k(n)}}function b(t){t.preventDefault();var o=e(this).parent().index();k(e(".ms-left .ms-section").eq(o))}function w(){var t=e(this).data("tooltip");e('<div class="multiscroll-tooltip '+i.navigationPosition+'">'+t+"</div>").hide().appendTo(e(this)).fadeIn(200)}function y(){e(this).find(".multiscroll-tooltip").fadeOut(200,function(){e(this).remove()})}B(),W(),i.css3&&(i.css3=function(){var e,n=o.createElement("p"),i={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};o.body.insertBefore(n,null);for(var a in i)n.style[a]!==s&&(n.style[a]="translate3d(1px,1px,1px)",e=t.getComputedStyle(n).getPropertyValue(i[a]));return o.body.removeChild(n),e!==s&&e.length>0&&"none"!==e}()),".ms-section"!==i.sectionSelector&&e(i.sectionSelector).each(function(){e(this).addClass("ms-section")}),i.navigation&&(e("body").append('<div id="multiscroll-nav"><ul></ul></div>'),(d=e("#multiscroll-nav")).css("color",i.navigationColor),d.addClass(i.navigationPosition)),e(".ms-right, .ms-left").css({width:"50%",position:"absolute",height:"100%","-ms-touch-action":"none"}),e(".ms-right").css({right:"1px",top:"0","-ms-touch-action":"none","touch-action":"none"}),e(".ms-left").css({left:"0",top:"0","-ms-touch-action":"none","touch-action":"none"}),e(".ms-left .ms-section, .ms-right .ms-section").each(function(){var t,o=e(this).index();if((i.paddingTop||i.paddingBottom)&&e(this).css("padding",i.paddingTop+" 0 "+i.paddingBottom+" 0"),void 0!==i.sectionsColor[o]&&e(this).css("background-color",i.sectionsColor[o]),void 0!==i.anchors[o]&&e(this).attr("data-anchor",i.anchors[o]),i.verticalCentered&&(t=e(this)).addClass("ms-table").wrapInner('<div class="ms-tableCell" style="height: '+z(t)+'px" />'),e(this).closest(".ms-left").length&&i.navigation){var n="";i.anchors.length&&(n=i.anchors[o]);var s=i.navigationTooltips[o];void 0===s&&(s=""),i.navigation&&d.find("ul").append('<li data-tooltip="'+s+'"><a href="#'+n+'"><span></span></a></li>')}}),e(".ms-right").html(e(".ms-right").find(".ms-section").get().reverse()),e(".ms-left .ms-section, .ms-right .ms-section").each(function(){var t=e(this).index();e(this).css({height:"100%"}),!t&&i.navigation&&d.find("li").eq(t).find("a").addClass("active")}).promise().done(function(){e(".ms-left .ms-section.active").length||(e(".ms-right").find(".ms-section").last().addClass("active"),e(".ms-left").find(".ms-section").first().addClass("active")),i.navigation&&d.css("margin-top","-"+d.height()/2+"px"),e.isFunction(i.afterRender)&&i.afterRender.call(this),L(),P(),e(t).on("load",function(){var o,n;o=t.location.hash.replace("#",""),n=e('.ms-left .ms-section[data-anchor="'+o+'"]'),o.length&&k(n)})}),e(t).on("hashchange",x),e(o).keydown(function(t){clearTimeout(f);var n=e(o.activeElement);if(!n.is("textarea")&&!n.is("input")&&!n.is("select")&&i.keyboardScrolling){var s=t.which;e.inArray(s,[40,38,32,33,34])>-1&&t.preventDefault(),f=setTimeout(function(){!function(t){var o=t.shiftKey;switch(t.which){case 38:case 33:a.moveSectionUp();break;case 32:if(o){a.moveSectionUp();break}case 40:case 34:a.moveSectionDown();break;case 36:a.moveTo(1);break;case 35:a.moveTo(e(".ms-left .ms-section").length);break;default:;}}(t)},150)}}),e(o).mousedown(function(e){if(1==e.button)return e.preventDefault(),!1}),e(o).on("click","#multiscroll-nav a",b),e(o).on({mouseenter:w,mouseleave:y},"#multiscroll-nav li"),i.normalScrollElements&&(e(o).on("mouseenter",i.normalScrollElements,function(){a.setMouseWheelScrolling(!1)}),e(o).on("mouseleave",i.normalScrollElements,function(){a.setMouseWheelScrolling(!0)})),e(t).on("resize",T);var C=p;function T(){if(c){var s=e(o.activeElement);if(!s.is("textarea")&&!s.is("input")&&!s.is("select")){var i=e(t).height();n.abs(i-C)>20*n.max(C,i)/100&&(E(!0),C=i)}}else clearTimeout(v),v=setTimeout(function(){E(!0)},350)}function E(o){p=e(t).height(),e(".ms-tableCell").each(function(){e(this).css({height:z(e(this).parent())})}),i.scrollOverflow&&scrollBarHandler.createScrollBarForAll(),L(),e.isFunction(i.afterResize)&&i.afterResize.call(this)}function L(){i.css3?(M(e(".ms-left"),"translate3d(0px, -"+e(".ms-left").find(".ms-section.active").position().top+"px, 0px)",!1),M(e(".ms-right"),"translate3d(0px, -"+e(".ms-right").find(".ms-section.active").position().top+"px, 0px)",!1)):(e(".ms-left").css("top",-e(".ms-left").find(".ms-section.active").position().top),e(".ms-right").css("top",-e(".ms-right").find(".ms-section.active").position().top))}function k(t){var o=t.index(),n=e(".ms-right").find(".ms-section").eq(h-1-o),s=t.data("anchor"),a=e(".ms-left .ms-section.active").index()+1,l=function(t){var o=e(".ms-left .ms-section.active").index(),n=t.index();if(o>n)return"up";return"down"}(t);u=!0;var c,m,d,v=t.position().top,f=n.position().top;if(n.addClass("active").siblings().removeClass("active"),t.addClass("active").siblings().removeClass("active"),function(e){i.anchors.length&&(location.hash=e);P()}(s),i.css3){e.isFunction(i.onLeave)&&i.onLeave.call(this,a,o+1,l);var p="translate3d(0px, -"+v+"px, 0px)",g="translate3d(0px, -"+f+"px, 0px)";M(e(".ms-left"),p,!0),M(e(".ms-right"),g,!0),setTimeout(function(){e.isFunction(i.afterLoad)&&i.afterLoad.call(this,s,o+1),setTimeout(function(){u=!1},r)},i.scrollingSpeed)}else e.isFunction(i.onLeave)&&i.onLeave.call(this,a,o+1,l),e(".ms-left").animate({top:-v},i.scrollingSpeed,i.easing,function(){e.isFunction(i.afterLoad)&&i.afterLoad.call(this,s,o+1),setTimeout(function(){u=!1},r)}),e(".ms-right").animate({top:-f},i.scrollingSpeed,i.easing);lastScrolledDestiny=s,c=s,i.menu&&(e(i.menu).find(".active").removeClass("active"),e(i.menu).find('[data-menuanchor="'+c+'"]').addClass("active")),m=s,d=o,i.navigation&&(e("#multiscroll-nav").find(".active").removeClass("active"),m?e("#multiscroll-nav").find('a[href="#'+m+'"]').addClass("active"):e("#multiscroll-nav").find("li").eq(d).find("a").addClass("active"))}function B(){o.addEventListener?(o.addEventListener("mousewheel",D,!1),o.addEventListener("wheel",D,!1)):o.attachEvent("onmousewheel",D)}function D(o){if(e(o.target).closest(".multiscroll-wrapp").length<=0)return!1;l.hasClass("on_scroller")&&o.preventDefault(),o=t.event||o;var s=n.max(-1,n.min(1,o.wheelDelta||-o.deltaY||-o.detail));return u||(s<0?a.moveSectionDown():a.moveSectionUp()),!1}function M(e,t,o){var n;e.toggleClass("ms-easing",o),e.css({"-webkit-transform":n=t,"-moz-transform":n,"-ms-transform":n,transform:n})}function P(){var t=e(".ms-left .ms-section.active"),o=t.data("anchor"),n=t.index(),s=String(n);i.anchors.length&&(s=o),s=s.replace("/","-").replace("#","");var a=new RegExp("\\b\\s?ms-viewing-[^\\s]+\\b","g");e("body")[0].className=e("body")[0].className.replace(a,""),e("body").addClass("ms-viewing-"+s)}function z(e){var t=p;if(i.paddingTop||i.paddingBottom){var o=parseInt(e.css("padding-top"))+parseInt(e.css("padding-bottom"));t=p-o}return t}a.moveSectionUp=function(){var t=e(".ms-left .ms-section.active").prev(".ms-section");!t.length&&i.loopTop&&(t=e(".ms-left .ms-section").last());var o=l.closest(".multiscroll-wrapp").offset().top;l.hasClass("on_scroller")?t.length?k(t):l.removeClass("on_scroller"):t.length&&(l.addClass("on_scroller"),e("html, body").animate({scrollTop:o},600))},a.moveSectionDown=function(){var t=e(".ms-left .ms-section.active").next(".ms-section");!t.length&&i.loopBottom&&(t=e(".ms-left .ms-section").first());var o=l.closest(".multiscroll-wrapp").offset().top;l.hasClass("on_scroller")?t.length?k(t):l.removeClass("on_scroller"):t.length&&(l.addClass("on_scroller"),e("html, body").animate({scrollTop:o},600))},a.moveTo=function(t){k(isNaN(t)?e('.ms-left [data-anchor="'+t+'"]'):e(".ms-left .ms-section").eq(t-1))},a.setKeyboardScrolling=function(e){i.keyboardScrolling=e},a.setMouseWheelScrolling=function(e){e?B():o.addEventListener?(o.removeEventListener("mousewheel",D,!1),o.removeEventListener("wheel",D,!1)):o.detachEvent("onmousewheel",D)},a.setScrollingSpeed=function(e){i.scrollingSpeed=e};var F=0,R=0;function Y(o){if(_(o)){event.preventDefault();e(".ms-left .ms-section.active");if(!u){var s=X(o);R=s.y,s.x,n.abs(F-R)>e(t).height()/100*i.touchSensitivity&&(F>R?a.moveSectionDown():R>F&&a.moveSectionUp())}}}function _(e){return void 0===e.pointerType||"mouse"!=e.pointerType}function I(e){if(_(e)){var t=X(e);F=t.y,t.x}}function W(){(m||c)&&(o.removeEventListener(S.touchstart,I),o.removeEventListener(S.touchmove,Y,{passive:!1}),o.addEventListener(S.touchstart,I),o.addEventListener(S.touchmove,Y,{passive:!1}))}function X(e){var t=[];return t.y=void 0!==e.pageY&&(e.pageY||e.pageX)?e.pageY:e.touches[0].pageY,t.x=void 0!==e.pageX&&(e.pageY||e.pageX)?e.pageX:e.touches[0].pageX,m&&_(e)&&void 0!==e.touches&&(t.y=e.touches[0].pageY,t.x=e.touches[0].pageX),t}a.destroy=function(){a.setKeyboardScrolling(!1),a.setMouseWheelScrolling(!1),(m||c)&&(o.removeEventListener(S.touchstart,I),o.removeEventListener(S.touchmove,Y,{passive:!1})),e(t).off("hashchange",x).off("resize",T),e(o).off("mouseenter","#multiscroll-nav li").off("mouseleave","#multiscroll-nav li").off("click","#multiscroll-nav a")},a.build=function(){a.setKeyboardScrolling(!0),a.setMouseWheelScrolling(!0),W(),e(t).on("hashchange",x).on("resize",T),e(o).on("mouseenter","#multiscroll-nav li",w).on("mouseleave","#multiscroll-nav li",y).on("click","#multiscroll-nav a",b)}}}(jQuery,window,document,Math);